<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FilmangStream</title>

<style>
:root{
  --red:#e50914;
  --bg:#141414;
  --card:#1f1f1f;
}
body{
  margin:0;
  background:var(--bg);
  color:#fff;
  font-family:Arial, sans-serif;
}
header{
  background:var(--red);
  padding:15px;
  font-size:22px;
  font-weight:bold;
  text-align:center;
}
.search{
  padding:10px;
}
.search input{
  width:100%;
  padding:12px;
  border:none;
  border-radius:6px;
}
.section{
  padding:10px;
}
h2{
  margin:10px 0;
}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(130px,1fr));
  gap:12px;
}
.card{
  background:var(--card);
  border-radius:8px;
  overflow:hidden;
  cursor:pointer;
  transition:.2s;
}
.card:hover{
  transform:scale(1.05);
}
.card img{
  width:100%;
}
.card p{
  font-size:13px;
  padding:6px;
  text-align:center;
}

/* PLAYER MODAL */
#playerBox{
  position:fixed;
  top:0;left:0;
  width:100%;
  height:100%;
  background:#000;
  display:none;
  flex-direction:column;
  z-index:999;
}
#playerHeader{
  background:var(--red);
  padding:12px;
  font-weight:bold;
  cursor:pointer;
}
#playerFrame{
  width:100%;
  height:100%;
  border:none;
}
</style>
</head>

<body>

<header>üé¨ FilmangStream</header>

<div class="search">
  <input id="search" placeholder="Rechercher film, s√©rie, anime...">
</div>

<div class="section">
<h2>üî• Films populaires</h2>
<div class="grid" id="movies"></div>
</div>

<div class="section">
<h2>üì∫ S√©ries populaires</h2>
<div class="grid" id="series"></div>
</div>

<div class="section">
<h2>üç• Animes</h2>
<div class="grid" id="anime"></div>
</div>

<div class="section">
<h2>üì° TV en direct</h2>
<div class="grid">
  <div class="card" onclick="openTV()">
    <img src="https://i.imgur.com/Z6XhK9N.png">
    <p>Cha√Ænes TV</p>
  </div>
</div>
</div>

<!-- PLAYER -->
<div id="playerBox">
  <div id="playerHeader" onclick="closePlayer()">‚¨Ö Retour</div>
  <iframe id="playerFrame" allowfullscreen></iframe>
</div>

<script>
const TMDB_KEY = "1073e4d36ef71f912da093a5eb38f091";
const IMG = "https://image.tmdb.org/t/p/w500";

/* API LOAD */
async function load(url){
  const r = await fetch(url);
  return await r.json();
}

/* DRAW CONTENT */
function draw(id,list,type){
  const box=document.getElementById(id);
  box.innerHTML="";
  list.forEach(i=>{
    if(!i.poster_path) return;
    const d=document.createElement("div");
    d.className="card";
    d.innerHTML=
      "<img src='"+IMG+i.poster_path+"'>" +
      "<p>"+(i.title||i.name)+"</p>";
    d.onclick=()=>openPlayer(type,i.id);
    box.appendChild(d);
  });
}

/* PLAYER */
function openPlayer(type,id){
  let src="";
  if(type==="movie") src="https://letsembed.cc/embed/movie/?id="+id;
  if(type==="tv") src="https://letsembed.cc/embed/tv/?id="+id+"/1/1";
  if(type==="anime") src="https://letsembed.cc/embed/anime/?id="+id+"/1/1";
  document.getElementById("playerFrame").src=src;
  document.getElementById("playerBox").style.display="flex";
}

function openTV(){
  document.getElementById("playerFrame").src="https://iptv-org.github.io/iptv/index.m3u";
  document.getElementById("playerBox").style.display="flex";
}

function closePlayer(){
  document.getElementById("playerFrame").src="";
  document.getElementById("playerBox").style.display="none";
}

/* INIT */
async function init(){
  const movies=await load(
    "https://api.themoviedb.org/3/movie/popular?api_key="+TMDB_KEY+"&language=fr"
  );
  draw("movies",movies.results,"movie");

  const series=await load(
    "https://api.themoviedb.org/3/tv/popular?api_key="+TMDB_KEY+"&language=fr"
  );
  draw("series",series.results,"tv");

  const anime=await load(
    "https://api.themoviedb.org/3/discover/tv?api_key="+TMDB_KEY+"&with_genres=16&language=fr"
  );
  draw("anime",anime.results,"anime");
}

init();
</script>

</body>
</html>
