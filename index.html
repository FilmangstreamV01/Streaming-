<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Stream Ultimate</title>
    <style>
        /* --- CONFIGURATION GLOBALE --- */
        :root {
            --bg-color: #0a0a0a;
            --card-bg: #1f1f1f;
            --text-main: #fff;
            --accent: #E50914; /* Rouge style Netflix */
        }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; 
            background-color: var(--bg-color); 
            color: var(--text-main); 
            margin: 0; 
            padding-bottom: 80px;
            overflow-x: hidden;
        }

        /* --- HEADER --- */
        header {
            padding: 20px 4%;
            background: linear-gradient(to bottom, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0) 100%);
            position: sticky;
            top: 0;
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .logo { 
            color: var(--accent); 
            font-size: 1.8rem; 
            font-weight: 800; 
            text-transform: uppercase; 
            letter-spacing: -1px;
        }

        /* --- SECTION SHORTS (Style TikTok) --- */
        .shorts-container {
            margin-bottom: 40px;
            padding-left: 4%;
        }
        .shorts-track {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding-bottom: 20px;
            scroll-snap-type: x mandatory;
        }
        .shorts-track::-webkit-scrollbar { display: none; }
        
        .short-card {
            min-width: 160px;
            height: 280px;
            background: #333;
            border-radius: 12px;
            position: relative;
            flex-shrink: 0;
            scroll-snap-align: start;
            cursor: pointer;
            overflow: hidden;
            border: 2px solid transparent;
            transition: border 0.2s;
        }
        .short-card:hover { border-color: var(--accent); }
        .short-card img { width: 100%; height: 100%; object-fit: cover; }
        .short-badge {
            position: absolute;
            bottom: 10px; left: 10px; right: 10px;
            font-size: 0.8rem;
            font-weight: bold;
            text-shadow: 0 1px 3px rgba(0,0,0,0.8);
        }

        /* --- SECTIONS STANDARDS (Films, S√©ries...) --- */
        .section-title {
            font-size: 1.4rem;
            font-weight: 700;
            margin: 30px 0 10px 4%;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .section-tag {
            font-size: 0.8rem;
            background: #333;
            padding: 2px 8px;
            border-radius: 4px;
            color: #aaa;
            font-weight: normal;
        }

        .horizontal-scroll {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 10px 4%;
            scroll-behavior: smooth;
        }
        .horizontal-scroll::-webkit-scrollbar { height: 6px; }
        .horizontal-scroll::-webkit-scrollbar-thumb { background: #444; border-radius: 3px; }

        .video-card {
            min-width: 280px;
            background: var(--card-bg);
            border-radius: 6px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
        }
        .video-card:hover {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 10px 20px rgba(0,0,0,0.7);
        }
        .thumbnail-container {
            width: 100%;
            aspect-ratio: 16/9;
            overflow: hidden;
        }
        .thumbnail-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .card-info { padding: 10px; }
        .card-title { font-size: 0.95rem; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .card-meta { font-size: 0.8rem; color: #aaa; margin-top: 5px; }

        /* --- LECTEUR PLEIN √âCRAN (MODAL) --- */
        #video-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        #modal-content {
            width: 90%;
            max-width: 1000px;
            aspect-ratio: 16/9;
            background: #000;
            position: relative;
        }
        #modal-close {
            position: absolute;
            top: 20px; right: 30px;
            color: white;
            font-size: 40px;
            cursor: pointer;
            z-index: 1001;
        }
        iframe { width: 100%; height: 100%; border: none; }

    </style>
</head>
<body>

    <header>
        <div class="logo">STREAMFLIX</div>
        <div style="font-size:0.9rem; color:#aaa;">Compte: Premium</div>
    </header>

    <h2 class="section-title">üì± Shorts & Cr√©ations Rapides</h2>
    <div class="shorts-container">
        <div class="shorts-track" id="shorts-row">
            </div>
    </div>

    <div id="main-content"></div>

    <div id="video-modal">
        <div id="modal-close" onclick="closeModal()">&times;</div>
        <div id="modal-content">
            <div id="player-target"></div>
        </div>
        <h3 id="modal-title" style="margin-top:20px; text-align:center;"></h3>
    </div>

    <script>
        // --- TON TOKEN ---
        const token = '1660578aadf69be53aa21547e9dfa8dc'; 

        // --- CONFIGURATION DU CONTENU ---
        // On cr√©e plusieurs "rang√©es" pour simuler une grosse biblioth√®que
        const contentMap = [
            { type: 'movies', title: "üçø √Ä la Une : Films & Courts M√©trages", query: "/channels/shortoftheweek/videos" },
            { type: 'movies', title: "üé≠ Com√©die & Spectacles", query: "/categories/comedy/videos" },
            { type: 'series', title: "üì∫ S√©ries & Fiction", query: "/categories/narrative/videos" }, // Vimeo 'Narrative' ressemble aux s√©ries
            { type: 'live',   title: "üî¥ Actualit√©s & Reportages (Style TV)", query: "/categories/journalism/videos" },
            { type: 'music',  title: "üéµ Musique & Concerts", query: "/categories/music/videos" },
            { type: 'art',    title: "üé® Animation & Arts", query: "/categories/animation/videos" }
        ];

        // --- FONCTIONS ---

        async function initSite() {
            // 1. Charger les Shorts (On triche un peu : on prend des vid√©os "Staff Picks" pour la d√©mo)
            loadShorts();

            // 2. Charger les rang√©es principales
            const mainContainer = document.getElementById('main-content');
            
            for (const section of contentMap) {
                // Cr√©er le HTML de la section
                const sectionHTML = document.createElement('div');
                sectionHTML.innerHTML = `
                    <div class="section-title">
                        ${section.title} 
                        <span class="section-tag">${section.type.toUpperCase()}</span>
                    </div>
                    <div class="horizontal-scroll" id="row-${section.type}-${Math.random().toString(36).substr(2, 5)}">
                        <p style="color:#444; padding:20px;">Chargement...</p>
                    </div>
                `;
                mainContainer.appendChild(sectionHTML);
                
                // R√©cup√©rer l'ID unique qu'on vient de cr√©er pour y mettre les vid√©os
                const rowId = sectionHTML.querySelector('.horizontal-scroll').id;
                
                // Lancer la requ√™te API
                fetchCategory(section.query, rowId);
            }
        }

        async function loadShorts() {
            const container = document.getElementById('shorts-row');
            try {
                // On cherche des vid√©os de la cat√©gorie "Experimental" ou "Travel" pour l'effet Shorts
                const response = await fetch(`https://api.vimeo.com/categories/experimental/videos?per_page=12`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const data = await response.json();
                
                container.innerHTML = '';
                data.data.forEach(video => {
                    // On essaie de trouver une image format portrait, sinon on prend la normale
                    const img = video.pictures.sizes[2].link; 
                    
                    const card = document.createElement('div');
                    card.className = 'short-card';
                    card.onclick = () => openModal(video.embed.html, video.name);
                    card.innerHTML = `
                        <img src="${img}" alt="${video.name}">
                        <div class="short-badge">‚ñ∂ ${video.duration}s</div>
                    `;
                    container.appendChild(card);
                });
            } catch (e) { console.error("Erreur Shorts", e); }
        }

        async function fetchCategory(endpoint, containerId) {
            try {
                // On demande 15 vid√©os par rang√©e pour permettre le scroll
                const response = await fetch(`https://api.vimeo.com${endpoint}?per_page=15`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if(!response.ok) throw new Error("API Error");
                
                const data = await response.json();
                const container = document.getElementById(containerId);
                container.innerHTML = '';

                data.data.forEach(video => {
                    // R√©cup√©ration de l'image (thumbnail)
                    const thumb = video.pictures.sizes[3] ? video.pictures.sizes[3].link : video.pictures.sizes[0].link;
                    
                    const card = document.createElement('div');
                    card.className = 'video-card';
                    // Au clic, on appelle la fonction openModal
                    card.onclick = () => openModal(video.embed.html, video.name);
                    
                    card.innerHTML = `
                        <div class="thumbnail-container">
                            <img src="${thumb}" loading="lazy" alt="${video.name}">
                        </div>
                        <div class="card-info">
                            <div class="card-title">${video.name}</div>
                            <div class="card-meta">Dur√©e : ${(video.duration/60).toFixed(0)} min</div>
                        </div>
                    `;
                    container.appendChild(card);
                });

            } catch (error) {
                console.error(error);
            }
        }

        // --- GESTION DU PLEIN √âCRAN (MODAL) ---
        function openModal(embedCode, title) {
            const modal = document.getElementById('video-modal');
            const target = document.getElementById('player-target');
            const titleTarget = document.getElementById('modal-title');

            // On injecte le code iframe de Vimeo
            target.innerHTML = embedCode;
            titleTarget.innerText = title;
            
            // On affiche le modal
            modal.style.display = 'flex';
        }

        function closeModal() {
            const modal = document.getElementById('video-modal');
            const target = document.getElementById('player-target');
            
            modal.style.display = 'none';
            target.innerHTML = ''; // On coupe la vid√©o en vidant le HTML
        }

        // Lancement
        initSite();

    </script>
</body>
</html>
