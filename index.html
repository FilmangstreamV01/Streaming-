<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>FilmAngStream Live</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <style>
        body { background: #0a0a0b; color: #fff; font-family: sans-serif; text-align: center; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 30px; }
        .video-card { background: #161618; border-radius: 10px; border: 1px solid #333; overflow: hidden; }
        .player { position: relative; padding-top: 56.25%; }
        .player iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .btn { background: #00adef; color: #fff; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>
    <h1>FILMANGSTREAM</h1>
    <div id="auth-section" style="margin-bottom: 20px;">
        <button class="btn" onclick="login()">Se connecter avec Google</button>
    </div>
    <div id="vimeo-grid" class="grid"></div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyA3J4K7ZMGYoWMTxBVlN5-Lsgb5orolLi0",
            authDomain: "filmangstream.firebaseapp.com",
            projectId: "filmangstream",
            storageBucket: "filmangstream.appspot.com",
            messagingSenderId: "887863323394",
            appId: "1:887863323394:web:6e6328905f32a74794e775"
        };
        firebase.initializeApp(firebaseConfig);
        const VIM_TK = "ZtDImh52MQIIWDo4IiLtVVcKu7SIiLpqIYEwKvtferpOZy5ltN5uW6ayed+syId/6sJctfRScopKdkJt9pi/JSFSgP87yfie3C2pcEY0/msCihm3xCVuh2z8XcqOLNal";

        function login() {
            const provider = new firebase.auth.GoogleAuthProvider();
            firebase.auth().signInWithPopup(provider);
        }

        async function loadVideos() {
            const res = await fetch('https://api.vimeo.com/me/videos', {
                headers: { 'Authorization': 'Bearer ' + VIM_TK }
            });
            const data = await res.json();
            if(data.data) {
                document.getElementById('vimeo-grid').innerHTML = data.data.map(v => `
                    <div class="video-card">
                        <div class="player"><iframe src="https://player.vimeo.com/video/${v.uri.split('/')[2]}" frameborder="0" allowfullscreen></iframe></div>
                        <div style="padding:10px;">${v.name}</div>
                    </div>
                `).join('');
            }
        }

        firebase.auth().onAuthStateChanged(user => {
            if (user) {
                document.getElementById('auth-section').innerHTML = "Connect√© : " + user.displayName;
            }
            loadVideos();
        });
    </script>
</body>
</html>
